<!DOCTYPE html>
<html>
<head>
    <style>
        .game-div {
            background-color: blue;
            color: white;
            padding: 10px;
            margin: 10px auto;
            border-radius: 5px;
            text-align: center;
            font-size: 20px;
            width: 500px;
        }
    </style>
</head>
<body>
    <h1>NBA BETTING</h1>
    <button onclick="getGames()">Get</button>
    <div id="gamesContainer"></div>
</body>
<script>
    async function getGames() {
        const url = 'https://api.the-odds-api.com/v4/sports/basketball_nba/odds?bookmakers=draftkings&markets=h2h&oddsFormat=american&apiKey=192b45e0a31758ac8b513084d90192ad';

        try {
            const response = await fetch(url);
            const data = await response.json();
            console.log((data))
            displayGames(parseData(data));
            
        } catch (error) {
            console.error('Error fetching NBA stats:', error);
        }
    }

    function parseData(data) {
        const formattedData = data.map(game => {
            const team1 = game.home_team;
            const team2 = game.away_team;
            const oddsTeam1 = game.bookmakers[0].markets[0].outcomes[0].price;
            const oddsTeam2 = game.bookmakers[0].markets[0].outcomes[1].price;
            const date = game.commence_time;
            return [`${team1} vs ${team2}`, oddsTeam1, oddsTeam2, date];
        });
        return formattedData;
    }

    function displayGames(formattedData) {
        const gamesContainer = document.getElementById('gamesContainer');
        gamesContainer.innerHTML = '';
        formattedData.forEach(game => {
            const gameDiv = document.createElement('div');
            gameDiv.className = 'game-div';
            const teams = game[0].split(" vs ");
            gameDiv.innerHTML = `<div>${game[0]}</div><button class="teamButton" data-game="${game[0]}" data-team="${teams[0]}" data-odd="${game[1]}" data-date="${game[3]}">${game[1]}</button><button class="teamButton" data-game="${game[0]}" data-team="${teams[1]}" data-odd="${game[2]}" data-date="${game[3]}">${game[2]}</button>`;
            gamesContainer.appendChild(gameDiv);
        });
    
        // Add event listener to all buttons with class 'teamButton'
        const teamButtons = document.querySelectorAll('.teamButton');
        teamButtons.forEach(button => {
            button.addEventListener('click', () => {
                const gameName = button.getAttribute('data-game');
                const teamPicked = button.getAttribute('data-team');
                const odd = button.getAttribute('data-odd');
                const dateBefore = button.getAttribute('data-date')
                const date = dateBefore.substring(0,10)
                const betAmount = prompt(`Enter the amount to bet on ${teamPicked}:`);
                if (betAmount !== null && !isNaN(parseFloat(betAmount))) {
                    storeDataLocal(gameName, teamPicked, odd, date, parseFloat(betAmount));
                }
            });
        });
    }
    
    function storeDataLocal(gameName, teamPicked, odd, date, cash) {
        console.log("Game Name:", gameName);
        console.log("Team Picked:", teamPicked);
        console.log("Odd:", odd);
        console.log("Date:", date);
        console.log("Cash:", cash);
    }
</script>
</html>
